<!DOCTYPE html>
<title>tty.js</title>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="user.css">

<h1>tty.js</h1>

<div id="help">
  <p>Click the titlebar to drag.</p>
  <p>Double-click titlebar to maximize.</p>
  <p>Click the lower-right corner to resize.</p>
  <p>Click the tilde to open a new tab.</p>
  <p>Click the tilde with a modifier to close the window.</p>
</div>

<button id="open" onclick="new tty.Window(false, {title:'Local host', user:'foo', host:'localhost', password:'bar'})">Open Terminal</button>

<script src="socket.io/socket.io.js"></script>
<script src="term.js"></script>
<script src="options.js"></script>
<script src="tty.js"></script>
<script src="user.js"></script>
<script>
(function() {
  var on = Terminal.on;
  var off = Terminal.off;

  function load() {
    if (load.done) return;
    load.done = true;

    off(document, 'load', load);
    off(document, 'DOMContentLoaded', load);

    if (document.location.pathname) {
      // "/foo/bar/baz" -> "/foo/bar/socket.io"
      var parts = document.location.pathname.split('/')
        , base = parts.slice(0, parts.length - 1).join('/') + '/'
        , resource = base.substring(1) + 'socket.io';

      window.socket = io.connect(null, { resource: resource });
    } else {
      window.socket = io.connect();
    }

    tty.open(window.socket);
  }

  on(document, 'load', load);
  on(document, 'DOMContentLoaded', load);
  setTimeout(load, 200);
})();
</script>
